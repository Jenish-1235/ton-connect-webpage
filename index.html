<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Platform</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Placeholder for Image -->
        <div class="image-placeholder">
            <img src="placeholder.png" alt="Placeholder Image">
        </div>

        <!-- Main Message -->
        <div class="main-message">
            <h2>Ready to play?<br>Connect your wallet and dive in!</h2>
        </div>

        <!-- Connect Wallet Button -->
        <div class="connect-wallet">
            <button id="connect-wallet-btn" onclick="connectWallet()">Connect Wallet</button>
        </div>
    </div>

    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    <script>
        // Initialize TonConnect SDK
        const connector = new TonConnectSDK.TonConnect({
            manifestUrl: "https://raw.githubusercontent.com/nuex001/Tonkeepermanifest/main/tonconnect-manifest.json",
        });

        // Connect Wallet Function
        const connectWallet = () => {
            const walletConnectionSource = {
                universalLink: "https://app.tonkeeper.com/ton-connect", // Link to TON Wallet
                bridgeUrl: "https://bridge.tonapi.io/bridge", // Bridge URL for communication
            };

            // Initiate connection and open in new tab
            const universalLink = connector.connect(walletConnectionSource);
            window.open(universalLink, "_blank");
        };

        // Listen for changes in connection status
        connector.onStatusChange((status) => {
            console.log("Connection status changed:", status);
            
            if (status && status.account) {
                const rawAddress = status.account.address; // Get wallet address
                
                // You can convert the raw address into a base64 format, for example
                const apiUrl = `https://toncenter.com/api/v2/packAddress?address=${encodeURIComponent(rawAddress)}`;
                
                // Fetch packed address and handle accordingly
                fetch(apiUrl, {
                    method: "GET",
                    headers: { accept: "application/json" },
                })
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log("Packed Address:", data.result);
                    } else {
                        console.error("Error:", data);
                    }
                });
            }
        });
    </script>
</body>
</html>
